      INTEGER A$BUF(200)
      INTEGER NAME(128),MESSA0(102),EPROM0(102),STR(102)
      INTEGER I,J,LINES0,FD,STATUS,DEFAU0,OPTIO0
      INTEGER STATE(4)
      INTEGER OPEN,GFNARG,PAGE
      INTEGER USAGE(66)
      INTEGER PARSCL
      INTEGER AAAAA0(22)
      INTEGER AAAAB0
      INTEGER AAAAC0(12)
      INTEGER AAAAD0(12)
      INTEGER AAAAE0
      DATA USAGE/245,243,225,231,229,186,160,240,231,160,219,173,229,221
     *,160,219,173,246,221,160,219,173,243,160,188,243,227,242,229,229,2
     *38,243,233,250,229,190,221,160,219,173,237,160,188,237,229,243,243
     *,225,231,229,190,221,160,251,188,240,225,244,232,238,225,237,229,1
     *90,253,0/
      DATA AAAAA0/219,229,236,246,221,238,188,233,231,238,190,243,188,24
     *2,233,190,237,188,242,243,190,0/
      DATA AAAAC0/170,243,160,219,170,170,233,171,221,191,160,0/
      DATA AAAAD0/170,243,160,219,170,170,233,164,221,191,160,0/
      IF((PARSCL(AAAAA0,A$BUF).NE.-3))GOTO 10000
        CALL ERROR(USAGE)
10000 OPTIO0=2
      STATUS=-2
      STATE(1)=1
      IF((A$BUF(229-225+1).EQ.0))GOTO 10001
        OPTIO0=OPTIO0+(1)
10001 IF((A$BUF(246-225+1).EQ.0))GOTO 10002
        OPTIO0=OPTIO0-(2)
10002 IF((A$BUF(237-225+1).EQ.0))GOTO 10003
        CALL SCOPY(A$BUF(A$BUF(237-225+27)),1,MESSA0,1)
        CALL CTOC(MESSA0,EPROM0,102)
        DEFAU0=0
        GOTO 10004
10003   DEFAU0=1
10004 IF((A$BUF(243-225+1).EQ.2))GOTO 10005
        A$BUF(243-225+27)=23
10005 LINES0=A$BUF(243-225+27)
10006 IF((STATUS.NE.-2))GOTO 10007
        AAAAB0=GFNARG(NAME,STATE)
        GOTO 10008
10009     GOTO 10007
10010     FD=OPEN(NAME,1)
          IF((FD.EQ.-3))GOTO 10011
            IF((DEFAU0.NE.1))GOTO 10012
              I=1
              J=1
              GOTO 10015
10013         I=I+(1)
10015         IF((NAME(I).EQ.0))GOTO 10014
                IF((J.GE.102-1))GOTO 10016
                  STR(J)=NAME(I)
                  IF((STR(J).NE.170))GOTO 10017
                    STR(J+1)=170
                    J=J+(1)
10017             J=J+(1)
10016         GOTO 10013
10014         STR(J)=0
              CALL ENCODE(MESSA0,102,AAAAC0,STR)
              CALL ENCODE(EPROM0,102,AAAAD0,STR)
10012       STATUS=PAGE(FD,MESSA0,EPROM0,LINES0,-11,OPTIO0)
            CALL CLOSE(FD)
            GOTO 10018
10011       CALL PRINT(-15,'*s: can''t open*n.',NAME)
10018   GOTO 10019
10020     GOTO 10007
10008   AAAAE0=AAAAB0+4
        GOTO(10020,10010,10009),AAAAE0
10019 GOTO 10006
10007 CALL SWT
      END
C ---- Long Name Map ----
C message                        messa0
C linesperpage                   lines0
C defaultprompt                  defau0
C eprompt                        eprom0
C options                        optio0
