      INTEGER A$BUF(200)
      INTEGER FD
      INTEGER OPEN
      INTEGER STATE(4),MODE
      INTEGER GFNARG
      INTEGER NAME(128),PAT(128)
      INTEGER AAAAA0
      INTEGER AAAAB0
      INTEGER AAAAC0
      INTEGER AAAAD0(17)
      INTEGER AAAAE0(17)
      INTEGER AAAAF0
      INTEGER AAAAG0
      INTEGER GETARG,GETPAT
      INTEGER AAAAH0(128)
      INTEGER AAAAI0(58)
      INTEGER PARSCL
      INTEGER AAAAJ0(17)
      INTEGER AAAAK0,AAAAL0,AAAAN0
      INTEGER GETLIN,MATCH,MAPDN
      INTEGER AAAAM0(500),CSLINE(500)
      INTEGER AAAAP0(3)
      DATA AAAAD0/170,243,186,160,227,225,238,167,244,160,239,240,229,23
     *8,170,238,0/
      DATA AAAAE0/170,243,186,160,227,225,238,167,244,160,239,240,229,23
     *8,170,238,0/
      DATA AAAAI0/213,243,225,231,229,186,160,230,233,238,228,160,188,24
     *0,225,244,244,229,242,238,190,160,251,173,251,227,252,233,252,236,
     *252,239,188,238,245,237,190,252,246,252,248,253,253,160,251,188,23
     *0,233,236,229,160,238,225,237,229,190,253,0/
      DATA AAAAJ0/227,233,236,246,248,238,188,233,231,238,190,239,188,23
     *9,233,190,0/
      DATA AAAAP0/186,160,0/
      AAAAA0=1
      GOTO 10000
10002 STATE(1)=1
10003   AAAAC0=GFNARG(NAME,STATE)
        GOTO 10004
10005     GOTO 10006
10007     FD=OPEN(NAME,1)
          IF((FD.EQ.-3))GOTO 10008
            AAAAB0=1
            GOTO 10001
10009       CALL CLOSE(FD)
            GOTO 10010
10008       CALL PRINT(-15,AAAAD0,NAME)
10010   GOTO 10011
10012     CALL PRINT(-15,AAAAE0,NAME)
        GOTO 10011
10004   AAAAF0=AAAAC0+4
        GOTO(10012,10007,10005),AAAAF0
10011 CONTINUE
      GOTO 10003
10006 CALL SWT
10000 IF((GETARG(1,AAAAH0,128).NE.-1))GOTO 10013
        CALL ERROR(AAAAI0)
10013 CALL DELARG(1)
      IF((AAAAH0(1).NE.254))GOTO 10014
        AAAAG0=2
        MODE=0
        GOTO 10015
10014   AAAAG0=1
        MODE=1
10015 IF((PARSCL(AAAAJ0,A$BUF).NE.-3))GOTO 10016
        CALL ERROR(AAAAI0)
10016 IF((A$BUF(239-225+1).EQ.0))GOTO 10017
        IF((A$BUF(239-225+1).EQ.2))GOTO 10018
          A$BUF(239-225+27)=1
10018   GOTO 10019
10017   IF((A$BUF(239-225+1).EQ.2))GOTO 10020
          A$BUF(239-225+27)=32767
10020 CONTINUE
10019 IF((A$BUF(248-225+1).EQ.0))GOTO 10021
        MODE=1+0-MODE
10021 IF((A$BUF(233-225+1).EQ.0))GOTO 10022
        CALL MAPSTR(AAAAH0(AAAAG0),1)
10022 IF((GETPAT(AAAAH0(AAAAG0),PAT).NE.-3))GOTO 10023
        CALL ERROR('illegal pattern.')
10023 GOTO 10024
10001 AAAAK0=0
      AAAAL0=0
10025 IF((GETLIN(AAAAM0,FD,500).EQ.-1))GOTO 10026
        AAAAL0=AAAAL0+(1)
        AAAAN0=1
        GOTO 10029
10027   AAAAN0=AAAAN0+(1)
10029   IF((AAAAM0(AAAAN0).EQ.0))GOTO 10028
          IF((A$BUF(233-225+1).EQ.0))GOTO 10030
            CSLINE(AAAAN0)=MAPDN(AAAAM0(AAAAN0))
            GOTO 10031
10030       CSLINE(AAAAN0)=AAAAM0(AAAAN0)
10031   GOTO 10027
10028   CSLINE(AAAAN0)=0
        IF((MATCH(CSLINE,PAT).NE.MODE))GOTO 10032
          IF((A$BUF(227-225+1).NE.0))GOTO 10033
            IF((A$BUF(246-225+1).EQ.0))GOTO 10034
              CALL PUTLIN(NAME,-11)
10034       IF((A$BUF(236-225+1).EQ.0))GOTO 10035
              CALL PUTDEC(AAAAL0,6,-11)
10035       IF((A$BUF(246-225+1).NE.0))GOTO 10037
            IF((A$BUF(236-225+1).NE.0))GOTO 10037
            GOTO 10036
10037         CALL PUTLIN(AAAAP0,-11)
10036       CALL PUTLIN(AAAAM0,-11)
10033     AAAAK0=AAAAK0+(1)
          IF((AAAAK0.LT.A$BUF(239-225+27)))GOTO 10038
            GOTO 10026
10038   CONTINUE
10032 GOTO 10025
10026 IF((A$BUF(227-225+1).EQ.0))GOTO 10039
        IF((A$BUF(246-225+1).EQ.0))GOTO 10040
          CALL PRINT(-11,'*s: .',NAME)
10040   CALL PRINT(-11,'*i*n.',AAAAK0)
10039 GOTO 10041
10041 GOTO 10009
10024 GOTO 10002
      END
      INTEGER FUNCTION GETPAT(ARG,PAT)
      INTEGER ARG(128),PAT(128)
      INTEGER MAKPAT
      GETPAT=MAKPAT(ARG,1,0,PAT)
      RETURN
      END
C ---- Long Name Map ----
C doarguments                    doarg0
