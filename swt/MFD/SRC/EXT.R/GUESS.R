# guess --- backstop command for the shell

   define (DB,#)           # control for debug code
   define (DB1, #)         # extra level of debug code
   define (FCW, 0)         # first char weighting, if any
   define (MAXBUF, 1000)
   define (MAXCOST, 3)
   define (MAXTIMES, 20)
   define (OVER_MAX, 1000)
   define (MAXLIST, 1200)
   define (MAXSIZE, 32)
   define (CHARS, 96)
   define (DELETE_COST, 1)  # cost parameters, replacement = 1 or 2
   define (INSERT_COST, 1)  # depending on adjacency
   define (TRANSPOSE_COST, 1)

   integer i, j, reply, choice, bp, cost, clist, maxc
   integer cptr (MAXTIMES, MAXCOST), cct (MAXCOST)
   integer getarg, dist, ctoc, ctoi
   character tarray (MAXLIST)    # holds command dictionary partition
   character arg (MAXLINE)
   character buf (MAXBUF)
   integer len

   common /gcom/ maxcost, arg, fcw
   integer maxcost, fcw

   common /dictp/ marks, sizes
   file_mark marks (MAXSIZE)
   integer   sizes (MAXSIZE)


   if (getarg (2, arg, MAXLINE) == EOF)
      maxc = MAXCOST
   else {
      i = 1
      maxc = ctoi (arg, i)
      if (maxc < 1 || maxc > MAXCOST || arg (i) ~= EOS)
         maxc = MAXCOST
      }

# method 3 - search multiple lists

   len = getarg (1, arg, MAXLINE)
   if (len == EOF)
      call bomb
   call mapstr (arg, LOWER)

   call read_header (clist)   # read header block from dictionary file

   bp = 1
   do i = 1, MAXCOST
      cct (i) = 0

   fcw = FCW         # fill in first character weight value

   maxcost = maxc

DB call print (STDOUT, "Argument is *s length *i*n"s, arg, len)

######### searchlist (arg, len, name) #########
DB call print (STDOUT, "Searching list size *2i*n"s, len)
DB1 call print (STDOUT, "List is *i words long*n"s, sizes (len))
DB1 call print (STDOUT, "Position is *l*n"s, marks (len))
   call getlist (tarray, len, clist)      # read in partition from dictionary

   for (j = 1; j <= sizes (len); j += len + 1) {
DB1 call print (STDOUT, "  checking *s*n"s, tarray (j))
      cost = dist (tarray (j))         # use the subarray
      if (cost > maxcost || cost < 1)  # forget it if too large
         next
      else if (cost < maxcost)   # alpha - beta pruning
         maxcost = cost

      if (cct (cost) < MAXTIMES) {     # add to lists we are building
         cct (cost) += 1
         cptr (cct (cost), cost) = bp
         bp += 1 + ctoc (tarray (j), buf (bp), MAXBUF - bp)
         }
      }

################################################
# loop back and forth around list  n +/- i until
# we reach a point where there is no possibility
# of finding a solution of cost < best cost so far
################################################

   i = 1

   while (i <= maxcost) {
#### searchlist (arg, len + i, name)
DB call print (STDOUT, "Searching list size *2i*n"s, len + i)
DB1 call print (STDOUT, "List is *i words long*n"s, sizes (len + i))
DB1 call print (STDOUT, "Position is *l*n"s, marks (len + i))
      call getlist (tarray, len + i, clist)      # read in partition from dictionary

      for (j = 1; j <= sizes (len + i); j += len + i + 1) {
DB1 call print (STDOUT, "  checking *s*n"s, tarray (j))
         cost = dist (tarray (j))         # use the subarray
         if (cost > maxcost || cost < 1)  # forget it if too large
            next
         else if (cost < maxcost)   # alpha - beta pruning
            maxcost = cost

         if (cct (cost) < MAXTIMES) {     # add to lists we are building
            cct (cost) += 1
            cptr (cct (cost), cost) = bp
            bp += 1 + ctoc (tarray (j), buf (bp), MAXBUF - bp)
            }
         }

########## searchlist (arg, len - i, name) #######
      if (len - i > 0) {      # can't search a list < 0!
DB call print (STDOUT, "Searching list size *2i*n"s, len - i)
DB1 call print (STDOUT, "List is *i words long*n"s, sizes (len - i))
DB1 call print (STDOUT, "Position is *l*n"s, marks (len - i))
         call getlist (tarray, len - i, clist)      # read in partition from dictionary

         for (j = 1; j <= sizes (len - i); j += len - i + 1) {
DB1 call print (STDOUT, "  checking *s*n"s, tarray (j))
            cost = dist (tarray (j))         # use the subarray
            if (cost > maxcost || cost < 1)  # forget it if too large
               next
            else if (cost < maxcost)   # alpha - beta pruning
               maxcost = cost

            if (cct (cost) < MAXTIMES) {     # add to lists we are building
               cct (cost) += 1
               cptr (cct (cost), cost) = bp
               bp += 1 + ctoc (tarray (j), buf (bp), MAXBUF - bp)
               }
            }
         }  # end of if len - i > 0 then

################################################

      i += 1
      }

   call close (clist)   # close up dictionary file


DB for (i = 1; i <= MAXCOST; i += 1) {
DB    call print (ERROUT, "Level *i cost list*n"s, i)
DB    for (j = 1; j <= cct (i); j += 1)
DB       call print (TTY, "   *2i: *s*n"s, j, buf (cptr (j, i)))
DB    }

   for (i = 1; i <= maxc && cct (i) == 0; i += 1)
      ;

   if (i > maxc || cct (i) >= MAXTIMES)
      call bomb

   if (cct (i) == 1) {
      call print (TTY, "By chance, did you mean '*s'? "s, buf (cptr (1, i)))
      call input (TTY, "*y"s, reply)
      if (reply == YES)
         choice = 1
      else
         choice = 0
      }
   else {
      call print (TTY, "You must differentiate amongst*n"s)
      for (j = 1; j <= cct (i); j += 1)
         call print (TTY, "   *2i: *s*n"s, j, buf (cptr (j, i)))
      call input (TTY, "Pick a number:  *i", reply)
      if (reply < 1 || reply > cct (i))
         choice = 0
      else
         choice = reply
      }

   if (choice == 0)
      call seterr (1000)
   else
      call print (STDOUT, "*s*n"s, buf (cptr (choice, i)))

   stop
   end



# dist --- compute the distance between two character strings

   integer function dist (name1)
   character name1 (MAXLINE)

   common /gcom/ maxcost, name2, fcw
   character name2 (MAXLINE)

   integer i1, i2, cost, maxcost, fcw

   i1 = 1
   i2 = 1
   cost = 0
   if (name1 (1) ~= name2 (1))   # weight matching first char important
      cost += fcw
   call rdist (name1, i1, i2, cost)
   return (cost)
   end

# read_header --- read in header block from dictionary file

   subroutine read_header (clist)
   file_des clist

   common /dictp/ marks, sizes
   file_mark marks (MAXSIZE)
   integer   sizes (MAXSIZE)

   file_des open
   integer readf, seekf

   clist = open ("=ubin=/clist"s, READ)   # try users first
   if (clist == ERR)
      clist = open ("=extra=/clist"s, READ) # if not, try system

   if (clist == ERR)    # if not, die, no clist file to read
      call bomb

   if (seekf (intl (0), clist) == ERR)
      call bomb
   if (readf (marks, MAXSIZE * 3, clist) == ERR)
      call bomb

   if (marks (1) ~= MAXSIZE * 3) {  # old clist file, no good
      call print (ERROUT, "This is the new version of guess*n"s)
      call error ("I cannot work until you run mkclist"s)
      }

   return
   end

# getlist --- get a partition from the dictionary file into array

   subroutine getlist (array, list, clist)
   character array (ARB)
   integer list
   file_des clist

   common /dictp/ marks, sizes
   file_mark marks (MAXSIZE)
   integer   sizes (MAXSIZE)

   integer readf, seekf

DB call print (STDOUT, "In get list for list *i*n"s, list)
   if (seekf (marks (list), clist) == ERR)
      call bomb

   if (readf (array, sizes (list), clist) == ERR)
      call bomb

DB call print (STDOUT, "Leaving get list...*n"s)
   return
   end

# bomb --- exit "gracefully"

   subroutine bomb

   common /gcom/ maxcost, arg, fcw
   integer maxcost, fcw

   character arg (MAXLINE)

   call putlin (arg, ERROUT)  # imitate Software Tools error message
   call error (": not found"s)

   return  # never make it here, error drops back to swt
   end



# rdist --- recursive distance function for two character strings

   define (OVER_MAX, 1000)
   define (CHARS, 96)
   define (DELETE_COST, 1)  # cost parameters, replacement = 1 or 2
   define (INSERT_COST, 1)  # depending on adjacency
   define (TRANSPOSE_COST, 1)

   subroutine rdist (name1, i1, i2, cost)
   integer i1, i2, cost
   character name1 (MAXLINE)

   common /gcom/ maxcost, name2, fcw
   character name2 (MAXLINE)
   integer maxcost, fcw
   integer costs (CHARS, CHARS)

   integer j1, j2, x, y
   integer cost1, cost2, cost3, cost4

   data costs / _
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ #
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # !
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,_ # "
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,_ # #
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,_ # $
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,_ # %
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,_ # &
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,_ # '
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,_ # (
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,_ # )
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,_ # *
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,_ # +
      1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,_ # ,
      2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,_ # -
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,_ # .
      2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,_ # /
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,1,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,_ # 0
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # 1
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,_ # 2
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,_ # 3
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,_ # 4
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,_ # 5
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,_ # 6
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,_ # 7
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,_ # 8
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,_ # 9
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,_ # :
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,_ # ;
      1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,_ # <
      2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,_ # =
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,_ # >
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,_ # ?
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,2,_ # @
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # A
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,1,2,1,2,2,2,2,2,_
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,1,2,1,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # B
      2,2,1,2,2,2,1,1,1,2,2,2,2,2,1,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,1,2,2,2,1,1,1,2,2,2,2,2,1,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # C
      2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,1,2,2,2,2,2,2,2,_
      2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,1,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # D
      2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,1,2,2,2,2,2,2,2,_
      2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,1,2,2,2,2,2,2,2,_
      2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,_ # E
      2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # F
      2,2,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # G
      2,2,1,2,2,2,1,1,1,2,2,2,2,2,1,2,2,2,1,2,1,2,1,2,2,1,2,2,2,2,2,2,_
      2,2,1,2,2,2,1,1,1,2,2,2,2,2,1,2,2,2,1,2,1,2,1,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # H
      2,2,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,_ # I
      2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,_ # J
      2,2,2,2,2,2,2,2,1,1,1,1,2,1,1,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,1,1,1,2,1,1,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,_ # K
      2,2,2,2,2,2,2,2,2,1,1,1,1,1,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,1,1,1,1,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,_ # L
      2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,_ # M
      2,2,2,2,2,2,2,2,1,2,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,2,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # N
      2,2,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,1,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,_ # O
      2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,1,1,2,1,2,2,1,2,2,2,2,2,2,2,2,1,1,1,2,1,2,2,_ # P
      1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # Q
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,_ # R
      2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # S
      2,1,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,1,2,1,2,2,2,2,2,_
      2,1,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,1,2,1,2,2,2,2,2,_
      2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,_ # T
      2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,_ # U
      2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # V
      2,2,1,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,1,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,_
      2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,_ # W
      2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # X
      2,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,1,2,2,2,2,2,_
      2,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,1,2,2,2,2,2,_
      2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,_ # Y
      2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # Z
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,1,2,2,2,2,2,_
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,1,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,2,_ # [
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # \
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,_
      2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,_ # ]
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,1,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,_ # ^
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # _
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,_
      2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,2,1,2,2,2,2,2,2,2,2,2,1,1,2,1,2,2,_ # `
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,1,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # a
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,1,2,1,2,2,2,2,2,_
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,1,2,1,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # b
      2,2,1,2,2,2,1,1,1,2,2,2,2,2,1,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,1,2,2,2,1,1,1,2,2,2,2,2,1,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # c
      2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,1,2,2,2,2,2,2,2,_
      2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,1,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # d
      2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,1,2,2,2,2,2,2,2,_
      2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,1,2,2,2,2,2,2,2,_
      2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,_ # e
      2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # f
      2,2,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # g
      2,2,1,2,2,2,1,1,1,2,2,2,2,2,1,2,2,2,1,2,1,2,1,2,2,1,2,2,2,2,2,2,_
      2,2,1,2,2,2,1,1,1,2,2,2,2,2,1,2,2,2,1,2,1,2,1,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # h
      2,2,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,_ # i
      2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,_ # j
      2,2,2,2,2,2,2,2,1,1,1,1,2,1,1,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,1,1,1,2,1,1,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,_ # k
      2,2,2,2,2,2,2,2,2,1,1,1,1,1,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,1,1,1,1,2,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,_ # l
      2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,_ # m
      2,2,2,2,2,2,2,2,1,2,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,2,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # n
      2,2,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,1,2,2,2,2,1,1,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,1,2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,_ # o
      2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,1,1,1,2,1,2,2,1,2,2,2,2,2,2,2,2,1,1,1,2,1,2,2,_ # p
      1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      1,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # q
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,_ # r
      2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # s
      2,1,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,1,2,1,2,2,2,2,2,_
      2,1,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,1,2,1,2,2,2,2,2,_
      2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,_ # t
      2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,_ # u
      2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # v
      2,2,1,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,_
      2,2,1,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,_
      2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,_ # w
      2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,1,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,2,1,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # x
      2,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,1,2,2,2,2,2,_
      2,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,1,2,2,2,2,2,_
      2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,_ # y
      2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,1,1,2,1,2,2,2,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # z
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,1,2,2,2,2,2,_
      2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,1,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,1,2,2,_ # {
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,_ # |
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,_
      2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,_ # }
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,1,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,_ # ~
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,_
      1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_ # 
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,_
      2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2 _
      /

   if (cost > maxcost)
      return

   if (name1 (i1) == EOS && name2 (i2) == EOS)
      return


   if (name1 (i1) == name2 (i2)) {  ##### Equal skip to next, 0 cost
      j1 = i1 + 1                   ##### for this step
      j2 = i2 + 1
      call rdist (name1, j1, j2, cost)
      return
      }

#
   if (name1 (i1) == EOS)
      cost1 = OVER_MAX
   else {                           ##### Delete a char in name1, 1 cost
      j1 = i1 + 1                   ##### for this step
      j2 = i2
      cost1 = cost + DELETE_COST
      if (i1 == 1 && name1 (j1) == name1 (j2))
         cost1 -= fcw               # take off first penalty if appropriate
      call rdist (name1, j1, j2, cost1)
      }

#
   if (name2 (i2) == EOS)
      cost2 = OVER_MAX
   else {                           ##### Insert a char in name1, 1 cost
      j1 = i1                       ##### for this step
      j2 = i2 + 1
      cost2 = cost + INSERT_COST
      if (i1 == 1 && name1 (j1) == name1 (j2))
         cost1 -= fcw               # take off first penalty if appropriate
      call rdist (name1, j1, j2, cost2)
      }

#
   if (name1 (i1) == EOS || name2 (i2) == EOS)
      cost3 = OVER_MAX
   else {                           ##### Replace a char in name1, cost
      x = name1 (i1) - :240 + 1     ##### depends on adjacency of chars
      y = name2 (i2) - :240 + 1
      j1 = i1 + 1
      j2 = i2 + 1
      cost3 = cost + costs (x, y)
      call rdist (name1, j1, j2, cost3)
      }

#
   if (name2(i2+1) == name1(i1) && name1(i1+1) == name2(i2)) {
      j1 = i1 + 2                   ##### char and next char in name1
      j2 = i2 + 2                   ##### and name2 are transposed, swap
      cost4 = cost + TRANSPOSE_COST ##### charge cost, and skip both
      if (i1 == 1)
         cost4 -= fcw               # deduct first char weight if present
      call rdist (name1, j1, j2, cost4)
      }
   else
      cost4 = OVER_MAX

   cost = min0 (cost1, cost2, cost3, cost4)

   return
   end
